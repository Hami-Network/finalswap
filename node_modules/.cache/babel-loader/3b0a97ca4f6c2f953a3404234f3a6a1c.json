{"ast":null,"code":"import _slicedToArray from\"C:/Users/97154/swap/hami/LokiswapUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"C:/Users/97154/swap/hami/LokiswapUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/97154/swap/hami/LokiswapUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _taggedTemplateLiteral from\"C:/Users/97154/swap/hami/LokiswapUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import React,{useCallback}from'react';import{useWeb3React}from'@web3-react/core';import styled from'styled-components';import BigNumber from'bignumber.js';import{Button,Flex,Heading,IconButton,AddIcon,MinusIcon,useModal}from'@pancakeswap/uikit';import{useLocation}from'react-router-dom';import Balance from'components/Balance';import{useTranslation}from'contexts/Localization';import{useAppDispatch}from'state';import{fetchFarmUserDataAsync}from'state/farms';import{useLpTokenPrice}from'state/farms/hooks';import{getBalanceAmount,getBalanceNumber}from'utils/formatBalance';import DepositModal from'../DepositModal';import WithdrawModal from'../WithdrawModal';import useUnstakeFarms from'../../hooks/useUnstakeFarms';import useStakeFarms from'../../hooks/useStakeFarms';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var IconButtonWrapper=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  svg {\\n    width: 20px;\\n  }\\n\"])));var StakeAction=function StakeAction(_ref){var stakedBalance=_ref.stakedBalance,tokenBalance=_ref.tokenBalance,tokenName=_ref.tokenName,pid=_ref.pid,multiplier=_ref.multiplier,apr=_ref.apr,displayApr=_ref.displayApr,addLiquidityUrl=_ref.addLiquidityUrl,cakePrice=_ref.cakePrice,lpLabel=_ref.lpLabel,isTokenOnly=_ref.isTokenOnly,decimals=_ref.decimals;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useStakeFarms=useStakeFarms(pid),onStake=_useStakeFarms.onStake;var _useUnstakeFarms=useUnstakeFarms(pid),onUnstake=_useUnstakeFarms.onUnstake;var location=useLocation();var dispatch=useAppDispatch();var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var lpPrice=useLpTokenPrice(tokenName,isTokenOnly);var handleStake=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(amount){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return onStake(amount,decimals);case 2:dispatch(fetchFarmUserDataAsync({account:account,pids:[pid]}));case 3:case\"end\":return _context.stop();}}},_callee);}));return function handleStake(_x){return _ref2.apply(this,arguments);};}();var handleUnstake=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(amount){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return onUnstake(amount,decimals);case 2:dispatch(fetchFarmUserDataAsync({account:account,pids:[pid]}));case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function handleUnstake(_x2){return _ref3.apply(this,arguments);};}();var displayBalance=useCallback(function(){var stakedBalanceBigNumber=getBalanceAmount(stakedBalance,decimals);if(stakedBalanceBigNumber.gt(0)&&stakedBalanceBigNumber.lt(0.0000001)){return'<0.0000001';}if(stakedBalanceBigNumber.gt(0)){return stakedBalanceBigNumber.toFixed(8,BigNumber.ROUND_DOWN);}return stakedBalanceBigNumber.toFixed(3,BigNumber.ROUND_DOWN);},[stakedBalance,decimals]);var _useModal=useModal(/*#__PURE__*/_jsx(DepositModal,{max:tokenBalance,stakedBalance:stakedBalance,onConfirm:handleStake,tokenName:tokenName,multiplier:multiplier,lpPrice:lpPrice,lpLabel:lpLabel,apr:apr,displayApr:displayApr,addLiquidityUrl:addLiquidityUrl,cakePrice:cakePrice,isTokenOnly:isTokenOnly,decimals:decimals})),_useModal2=_slicedToArray(_useModal,1),onPresentDeposit=_useModal2[0];var _useModal3=useModal(/*#__PURE__*/_jsx(WithdrawModal,{max:stakedBalance,onConfirm:handleUnstake,tokenName:tokenName,isTokenOnly:isTokenOnly,decimals:decimals})),_useModal4=_slicedToArray(_useModal3,1),onPresentWithdraw=_useModal4[0];var renderStakingButtons=function renderStakingButtons(){return stakedBalance.eq(0)?/*#__PURE__*/_jsx(Button,{onClick:onPresentDeposit,disabled:['history','archived'].some(function(item){return location.pathname.includes(item);}),children:isTokenOnly?t('Stake'):t('Stake LP')}):/*#__PURE__*/_jsxs(IconButtonWrapper,{children:[/*#__PURE__*/_jsx(IconButton,{variant:\"tertiary\",onClick:onPresentWithdraw,mr:\"6px\",children:/*#__PURE__*/_jsx(MinusIcon,{color:\"primary\",width:\"14px\"})}),/*#__PURE__*/_jsx(IconButton,{variant:\"tertiary\",onClick:onPresentDeposit,disabled:['history','archived'].some(function(item){return location.pathname.includes(item);}),children:/*#__PURE__*/_jsx(AddIcon,{color:\"primary\",width:\"14px\"})})]});};return/*#__PURE__*/_jsxs(Flex,{justifyContent:\"space-between\",alignItems:\"center\",children:[/*#__PURE__*/_jsxs(Flex,{flexDirection:\"column\",alignItems:\"flex-start\",children:[/*#__PURE__*/_jsx(Heading,{color:stakedBalance.eq(0)?'textDisabled':'text',children:displayBalance()}),stakedBalance.gt(0)&&lpPrice.gt(0)&&/*#__PURE__*/_jsx(Balance,{fontSize:\"12px\",color:\"textSubtle\",decimals:2,value:getBalanceNumber(lpPrice.times(stakedBalance),decimals),unit:\" USD\",prefix:\"~\"})]}),renderStakingButtons()]});};export default StakeAction;","map":{"version":3,"sources":["C:/Users/97154/swap/hami/LokiswapUI/src/views/Farms/components/FarmCard/StakeAction.tsx"],"names":["React","useCallback","useWeb3React","styled","BigNumber","Button","Flex","Heading","IconButton","AddIcon","MinusIcon","useModal","useLocation","Balance","useTranslation","useAppDispatch","fetchFarmUserDataAsync","useLpTokenPrice","getBalanceAmount","getBalanceNumber","DepositModal","WithdrawModal","useUnstakeFarms","useStakeFarms","IconButtonWrapper","div","StakeAction","stakedBalance","tokenBalance","tokenName","pid","multiplier","apr","displayApr","addLiquidityUrl","cakePrice","lpLabel","isTokenOnly","decimals","t","onStake","onUnstake","location","dispatch","account","lpPrice","handleStake","amount","pids","handleUnstake","displayBalance","stakedBalanceBigNumber","gt","lt","toFixed","ROUND_DOWN","onPresentDeposit","onPresentWithdraw","renderStakingButtons","eq","some","item","pathname","includes","times"],"mappings":"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","sourcesContent":["import React, { useCallback } from 'react'\r\nimport { useWeb3React } from '@web3-react/core'\r\nimport styled from 'styled-components'\r\nimport BigNumber from 'bignumber.js'\r\nimport { Button, Flex, Heading, IconButton, AddIcon, MinusIcon, useModal } from '@pancakeswap/uikit'\r\nimport { useLocation } from 'react-router-dom'\r\nimport Balance from 'components/Balance'\r\nimport { useTranslation } from 'contexts/Localization'\r\nimport { useAppDispatch } from 'state'\r\nimport { fetchFarmUserDataAsync } from 'state/farms'\r\nimport { useLpTokenPrice } from 'state/farms/hooks'\r\nimport { getBalanceAmount, getBalanceNumber } from 'utils/formatBalance'\r\nimport DepositModal from '../DepositModal'\r\nimport WithdrawModal from '../WithdrawModal'\r\nimport useUnstakeFarms from '../../hooks/useUnstakeFarms'\r\nimport useStakeFarms from '../../hooks/useStakeFarms'\r\n\r\ninterface FarmCardActionsProps {\r\n  stakedBalance?: BigNumber\r\n  tokenBalance?: BigNumber\r\n  tokenName?: string\r\n  pid?: number\r\n  multiplier?: string\r\n  apr?: number\r\n  displayApr?: string\r\n  addLiquidityUrl?: string\r\n  cakePrice?: BigNumber\r\n  lpLabel?: string\r\n  isTokenOnly?: boolean\r\n  isabletoharvest?: boolean\r\n  decimals?: number\r\n}\r\n\r\nconst IconButtonWrapper = styled.div`\r\n  display: flex;\r\n  svg {\r\n    width: 20px;\r\n  }\r\n`\r\n\r\nconst StakeAction: React.FC<FarmCardActionsProps> = ({\r\n  stakedBalance,\r\n  tokenBalance,\r\n  tokenName,\r\n  pid,\r\n  multiplier,\r\n  apr,\r\n  displayApr,\r\n  addLiquidityUrl,\r\n  cakePrice,\r\n  lpLabel,\r\n  isTokenOnly,\r\n  decimals,\r\n}) => {\r\n  const { t } = useTranslation()\r\n  const { onStake } = useStakeFarms(pid)\r\n  const { onUnstake } = useUnstakeFarms(pid)\r\n  const location = useLocation()\r\n  const dispatch = useAppDispatch()\r\n  const { account } = useWeb3React()\r\n  const lpPrice = useLpTokenPrice(tokenName, isTokenOnly)\r\n\r\n  const handleStake = async (amount: string) => {\r\n    await onStake(amount, decimals)\r\n    dispatch(fetchFarmUserDataAsync({ account, pids: [pid] }))\r\n  }\r\n\r\n  const handleUnstake = async (amount: string) => {\r\n    await onUnstake(amount, decimals)\r\n    dispatch(fetchFarmUserDataAsync({ account, pids: [pid] }))\r\n  }\r\n\r\n  const displayBalance = useCallback(() => {\r\n    const stakedBalanceBigNumber = getBalanceAmount(stakedBalance, decimals)\r\n    if (stakedBalanceBigNumber.gt(0) && stakedBalanceBigNumber.lt(0.0000001)) {\r\n      return '<0.0000001'\r\n    }\r\n    if (stakedBalanceBigNumber.gt(0)) {\r\n      return stakedBalanceBigNumber.toFixed(8, BigNumber.ROUND_DOWN)\r\n    }\r\n    return stakedBalanceBigNumber.toFixed(3, BigNumber.ROUND_DOWN)\r\n  }, [stakedBalance, decimals])\r\n\r\n  const [onPresentDeposit] = useModal(\r\n    <DepositModal\r\n      max={tokenBalance}\r\n      stakedBalance={stakedBalance}\r\n      onConfirm={handleStake}\r\n      tokenName={tokenName}\r\n      multiplier={multiplier}\r\n      lpPrice={lpPrice}\r\n      lpLabel={lpLabel}\r\n      apr={apr}\r\n      displayApr={displayApr}\r\n      addLiquidityUrl={addLiquidityUrl}\r\n      cakePrice={cakePrice}\r\n      isTokenOnly={isTokenOnly}\r\n      decimals={decimals}\r\n    />,\r\n  )\r\n  const [onPresentWithdraw] = useModal(\r\n    <WithdrawModal max={stakedBalance} onConfirm={handleUnstake} tokenName={tokenName} isTokenOnly={isTokenOnly} decimals={decimals}/>,\r\n  )\r\n\r\n  const renderStakingButtons = () => {\r\n    return stakedBalance.eq(0) ? (\r\n      <Button\r\n        onClick={onPresentDeposit}\r\n        disabled={['history', 'archived'].some((item) => location.pathname.includes(item))}  \r\n      >\r\n        {isTokenOnly ? t('Stake') : t('Stake LP')}\r\n      </Button>\r\n    ) : (\r\n      <IconButtonWrapper>\r\n        <IconButton variant=\"tertiary\" onClick={onPresentWithdraw} mr=\"6px\">\r\n          <MinusIcon color=\"primary\" width=\"14px\" />\r\n        </IconButton>\r\n        <IconButton\r\n          variant=\"tertiary\"\r\n          onClick={onPresentDeposit}\r\n          disabled={['history', 'archived'].some((item) => location.pathname.includes(item))}\r\n        >\r\n          <AddIcon color=\"primary\" width=\"14px\" />\r\n        </IconButton>\r\n      </IconButtonWrapper>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <Flex justifyContent=\"space-between\" alignItems=\"center\">\r\n      <Flex flexDirection=\"column\" alignItems=\"flex-start\">\r\n        <Heading color={stakedBalance.eq(0) ? 'textDisabled' : 'text'}>{displayBalance()}</Heading>\r\n        {stakedBalance.gt(0) && lpPrice.gt(0) && (\r\n          <Balance\r\n            fontSize=\"12px\"\r\n            color=\"textSubtle\"\r\n            decimals={2}\r\n            value={getBalanceNumber(lpPrice.times(stakedBalance), decimals)}\r\n            unit=\" USD\"\r\n            prefix=\"~\"\r\n          />\r\n        )}\r\n      </Flex>\r\n      {renderStakingButtons()}\r\n    </Flex>\r\n  )\r\n}\r\n\r\nexport default StakeAction\r\n"]},"metadata":{},"sourceType":"module"}