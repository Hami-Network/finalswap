{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/97154/swap/hami/LokiswapUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/97154/swap/hami/LokiswapUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/97154/swap/hami/LokiswapUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"C:/Users/97154/swap/hami/LokiswapUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3;import React,{memo,useCallback,useMemo,useState,useEffect}from'react';import{Button,Text,CheckmarkIcon,CogIcon,Input,Toggle,LinkExternal,useTooltip}from'@pancakeswap/uikit';import{useDispatch,useSelector}from'react-redux';import styled from'styled-components';import Card from'components/Card';import{UNSUPPORTED_LIST_URLS}from'config/constants/lists';import{parseENSAddress}from'utils/ENS/parseENSAddress';import{useTranslation}from'contexts/Localization';import useFetchListCallback from'../../hooks/useFetchListCallback';import{acceptListUpdate,removeList,disableList,enableList}from'../../state/lists/actions';import{useIsListActive,useAllLists,useActiveListUrls}from'../../state/lists/hooks';import uriToHttp from'../../utils/uriToHttp';import Column,{AutoColumn}from'../Layout/Column';import{ListLogo}from'../Logo';import Row,{RowFixed,RowBetween}from'../Layout/Row';import{CurrencyModalView}from'./types';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function listVersionLabel(version){return\"v\".concat(version.major,\".\").concat(version.minor,\".\").concat(version.patch);}var Wrapper=styled(Column)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n\"])));var RowWrapper=styled(Row)(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  background-color: \",\";\\n  border: solid 1px;\\n  border-color: \",\";\\n  transition: 200ms;\\n  align-items: center;\\n  padding: 1rem;\\n  border-radius: 20px;\\n\"])),function(_ref){var active=_ref.active,theme=_ref.theme;return active?\"\".concat(theme.colors.success,\"19\"):'transparent';},function(_ref2){var active=_ref2.active,theme=_ref2.theme;return active?theme.colors.success:theme.colors.tertiary;});function listUrlRowHTMLId(listUrl){return\"list-row-\".concat(listUrl.replace(/\\./g,'-'));}var ListRow=/*#__PURE__*/memo(function ListRow(_ref3){var listUrl=_ref3.listUrl;var listsByUrl=useSelector(function(state){return state.lists.byUrl;});var dispatch=useDispatch();var _listsByUrl$listUrl=listsByUrl[listUrl],list=_listsByUrl$listUrl.current,pending=_listsByUrl$listUrl.pendingUpdate;var isActive=useIsListActive(listUrl);var _useTranslation=useTranslation(),t=_useTranslation.t;var handleAcceptListUpdate=useCallback(function(){if(!pending)return;dispatch(acceptListUpdate(listUrl));},[dispatch,listUrl,pending]);var handleRemoveList=useCallback(function(){// eslint-disable-next-line no-alert\nif(window.confirm('Please confirm you would like to remove this list')){dispatch(removeList(listUrl));}},[dispatch,listUrl]);var handleEnableList=useCallback(function(){dispatch(enableList(listUrl));},[dispatch,listUrl]);var handleDisableList=useCallback(function(){dispatch(disableList(listUrl));},[dispatch,listUrl]);var _useTooltip=useTooltip(/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{children:list&&listVersionLabel(list.version)}),/*#__PURE__*/_jsx(LinkExternal,{external:true,href:\"https://tokenlists.org/token-list?url=\".concat(listUrl),children:t('See')}),/*#__PURE__*/_jsx(Button,{variant:\"danger\",scale:\"xs\",onClick:handleRemoveList,disabled:Object.keys(listsByUrl).length===1,children:t('Remove')}),pending&&/*#__PURE__*/_jsx(Button,{variant:\"text\",onClick:handleAcceptListUpdate,style:{fontSize:'12px'},children:t('Update list')})]}),{placement:'right-end',trigger:'click'}),targetRef=_useTooltip.targetRef,tooltip=_useTooltip.tooltip,tooltipVisible=_useTooltip.tooltipVisible;if(!list)return null;return/*#__PURE__*/_jsxs(RowWrapper,{active:isActive,id:listUrlRowHTMLId(listUrl),children:[tooltipVisible&&tooltip,list.logoURI?/*#__PURE__*/_jsx(ListLogo,{size:\"40px\",style:{marginRight:'1rem'},logoURI:list.logoURI,alt:\"\".concat(list.name,\" list logo\")}):/*#__PURE__*/_jsx(\"div\",{style:{width:'24px',height:'24px',marginRight:'1rem'}}),/*#__PURE__*/_jsxs(Column,{style:{flex:'1'},children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Text,{bold:true,children:list.name})}),/*#__PURE__*/_jsxs(RowFixed,{mt:\"4px\",children:[/*#__PURE__*/_jsxs(Text,{fontSize:\"12px\",mr:\"6px\",textTransform:\"lowercase\",children:[list.tokens.length,\" \",t('Tokens')]}),/*#__PURE__*/_jsx(\"span\",{ref:targetRef,children:/*#__PURE__*/_jsx(CogIcon,{color:\"text\",width:\"12px\"})})]})]}),/*#__PURE__*/_jsx(Toggle,{checked:isActive,onChange:function onChange(){if(isActive){handleDisableList();}else{handleEnableList();}}})]},listUrl);});var ListContainer=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  padding: 1rem 0;\\n  height: 100%;\\n  overflow: auto;\\n\"])));function ManageLists(_ref4){var setModalView=_ref4.setModalView,setImportList=_ref4.setImportList,setListUrl=_ref4.setListUrl;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),listUrlInput=_useState2[0],setListUrlInput=_useState2[1];var _useTranslation2=useTranslation(),t=_useTranslation2.t;var lists=useAllLists();// sort by active but only if not visible\nvar activeListUrls=useActiveListUrls();var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),activeCopy=_useState4[0],setActiveCopy=_useState4[1];useEffect(function(){if(!activeCopy&&activeListUrls){setActiveCopy(activeListUrls);}},[activeCopy,activeListUrls]);var handleInput=useCallback(function(e){setListUrlInput(e.target.value);},[]);var fetchList=useFetchListCallback();var validUrl=useMemo(function(){return uriToHttp(listUrlInput).length>0||Boolean(parseENSAddress(listUrlInput));},[listUrlInput]);var sortedLists=useMemo(function(){var listUrls=Object.keys(lists);return listUrls.filter(function(listUrl){// only show loaded lists, hide unsupported lists\nreturn Boolean(lists[listUrl].current)&&!UNSUPPORTED_LIST_URLS.includes(listUrl);}).sort(function(u1,u2){var l1=lists[u1].current;var l2=lists[u2].current;// first filter on active lists\nif((activeCopy===null||activeCopy===void 0?void 0:activeCopy.includes(u1))&&!(activeCopy===null||activeCopy===void 0?void 0:activeCopy.includes(u2))){return-1;}if(!(activeCopy===null||activeCopy===void 0?void 0:activeCopy.includes(u1))&&(activeCopy===null||activeCopy===void 0?void 0:activeCopy.includes(u2))){return 1;}if(l1&&l2){return l1.name.toLowerCase()<l2.name.toLowerCase()?-1:l1.name.toLowerCase()===l2.name.toLowerCase()?0:1;}if(l1)return-1;if(l2)return 1;return 0;});},[lists,activeCopy]);// temporary fetched list for import flow\nvar _useState5=useState(),_useState6=_slicedToArray(_useState5,2),tempList=_useState6[0],setTempList=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),addError=_useState8[0],setAddError=_useState8[1];useEffect(function(){function fetchTempList(){return _fetchTempList.apply(this,arguments);}// if valid url, fetch details for card\nfunction _fetchTempList(){_fetchTempList=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:fetchList(listUrlInput,false).then(function(list){return setTempList(list);}).catch(function(){return setAddError('Error importing list');});case 1:case\"end\":return _context.stop();}}},_callee);}));return _fetchTempList.apply(this,arguments);}if(validUrl){fetchTempList();}else{setTempList(undefined);if(listUrlInput!==''){setAddError('Enter valid list location');}}// reset error\nif(listUrlInput===''){setAddError(undefined);}},[fetchList,listUrlInput,validUrl]);// check if list is already imported\nvar isImported=Object.keys(lists).includes(listUrlInput);// set list values and have parent modal switch to import list view\nvar handleImport=useCallback(function(){if(!tempList)return;setImportList(tempList);setModalView(CurrencyModalView.importList);setListUrl(listUrlInput);},[listUrlInput,setImportList,setListUrl,setModalView,tempList]);return/*#__PURE__*/_jsxs(Wrapper,{children:[/*#__PURE__*/_jsxs(AutoColumn,{gap:\"14px\",children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Input,{id:\"list-add-input\",scale:\"lg\",placeholder:t('https:// or ipfs:// or ENS name'),value:listUrlInput,onChange:handleInput})}),addError?/*#__PURE__*/_jsx(Text,{color:\"failure\",style:{textOverflow:'ellipsis',overflow:'hidden'},children:addError}):null]}),tempList&&/*#__PURE__*/_jsx(AutoColumn,{style:{paddingTop:0},children:/*#__PURE__*/_jsx(Card,{padding:\"12px 20px\",children:/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsxs(RowFixed,{children:[tempList.logoURI&&/*#__PURE__*/_jsx(ListLogo,{logoURI:tempList.logoURI,size:\"40px\"}),/*#__PURE__*/_jsxs(AutoColumn,{gap:\"4px\",style:{marginLeft:'20px'},children:[/*#__PURE__*/_jsx(Text,{bold:true,children:tempList.name}),/*#__PURE__*/_jsxs(Text,{color:\"textSubtle\",small:true,textTransform:\"lowercase\",children:[tempList.tokens.length,\" \",t('Tokens')]})]})]}),isImported?/*#__PURE__*/_jsxs(RowFixed,{children:[/*#__PURE__*/_jsx(CheckmarkIcon,{width:\"16px\",mr:\"10px\"}),/*#__PURE__*/_jsx(Text,{children:t('Loaded')})]}):/*#__PURE__*/_jsx(Button,{width:\"fit-content\",onClick:handleImport,children:t('Import')})]})})}),/*#__PURE__*/_jsx(ListContainer,{children:/*#__PURE__*/_jsx(AutoColumn,{gap:\"md\",children:sortedLists.map(function(listUrl){return/*#__PURE__*/_jsx(ListRow,{listUrl:listUrl},listUrl);})})})]});}export default ManageLists;","map":{"version":3,"sources":["C:/Users/97154/swap/hami/LokiswapUI/src/components/SearchModal/ManageLists.tsx"],"names":["React","memo","useCallback","useMemo","useState","useEffect","Button","Text","CheckmarkIcon","CogIcon","Input","Toggle","LinkExternal","useTooltip","useDispatch","useSelector","styled","Card","UNSUPPORTED_LIST_URLS","parseENSAddress","useTranslation","useFetchListCallback","acceptListUpdate","removeList","disableList","enableList","useIsListActive","useAllLists","useActiveListUrls","uriToHttp","Column","AutoColumn","ListLogo","Row","RowFixed","RowBetween","CurrencyModalView","listVersionLabel","version","major","minor","patch","Wrapper","RowWrapper","active","theme","colors","success","tertiary","listUrlRowHTMLId","listUrl","replace","ListRow","listsByUrl","state","lists","byUrl","dispatch","list","current","pending","pendingUpdate","isActive","t","handleAcceptListUpdate","handleRemoveList","window","confirm","handleEnableList","handleDisableList","Object","keys","length","fontSize","placement","trigger","targetRef","tooltip","tooltipVisible","logoURI","marginRight","name","width","height","flex","tokens","ListContainer","div","ManageLists","setModalView","setImportList","setListUrl","listUrlInput","setListUrlInput","activeListUrls","activeCopy","setActiveCopy","handleInput","e","target","value","fetchList","validUrl","Boolean","sortedLists","listUrls","filter","includes","sort","u1","u2","l1","l2","toLowerCase","tempList","setTempList","addError","setAddError","fetchTempList","then","catch","undefined","isImported","handleImport","importList","textOverflow","overflow","paddingTop","marginLeft","map"],"mappings":"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","sourcesContent":["import React, { memo, useCallback, useMemo, useState, useEffect } from 'react'\r\nimport { Button, Text, CheckmarkIcon, CogIcon, Input, Toggle, LinkExternal, useTooltip } from '@pancakeswap/uikit'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport styled from 'styled-components'\r\nimport { TokenList, Version } from '@uniswap/token-lists'\r\nimport Card from 'components/Card'\r\nimport { UNSUPPORTED_LIST_URLS } from 'config/constants/lists'\r\nimport { parseENSAddress } from 'utils/ENS/parseENSAddress'\r\nimport { useTranslation } from 'contexts/Localization'\r\nimport useFetchListCallback from '../../hooks/useFetchListCallback'\r\n\r\nimport { AppDispatch, AppState } from '../../state'\r\nimport { acceptListUpdate, removeList, disableList, enableList } from '../../state/lists/actions'\r\nimport { useIsListActive, useAllLists, useActiveListUrls } from '../../state/lists/hooks'\r\nimport uriToHttp from '../../utils/uriToHttp'\r\n\r\nimport Column, { AutoColumn } from '../Layout/Column'\r\nimport { ListLogo } from '../Logo'\r\nimport Row, { RowFixed, RowBetween } from '../Layout/Row'\r\nimport { CurrencyModalView } from './types'\r\n\r\nfunction listVersionLabel(version: Version): string {\r\n  return `v${version.major}.${version.minor}.${version.patch}`\r\n}\r\n\r\nconst Wrapper = styled(Column)`\r\n  width: 100%;\r\n  height: 100%;\r\n`\r\n\r\nconst RowWrapper = styled(Row)<{ active: boolean }>`\r\n  background-color: ${({ active, theme }) => (active ? `${theme.colors.success}19` : 'transparent')};\r\n  border: solid 1px;\r\n  border-color: ${({ active, theme }) => (active ? theme.colors.success : theme.colors.tertiary)};\r\n  transition: 200ms;\r\n  align-items: center;\r\n  padding: 1rem;\r\n  border-radius: 20px;\r\n`\r\n\r\nfunction listUrlRowHTMLId(listUrl: string) {\r\n  return `list-row-${listUrl.replace(/\\./g, '-')}`\r\n}\r\n\r\nconst ListRow = memo(function ListRow({ listUrl }: { listUrl: string }) {\r\n  const listsByUrl = useSelector<AppState, AppState['lists']['byUrl']>((state) => state.lists.byUrl)\r\n  const dispatch = useDispatch<AppDispatch>()\r\n  const { current: list, pendingUpdate: pending } = listsByUrl[listUrl]\r\n\r\n  const isActive = useIsListActive(listUrl)\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const handleAcceptListUpdate = useCallback(() => {\r\n    if (!pending) return\r\n    dispatch(acceptListUpdate(listUrl))\r\n  }, [dispatch, listUrl, pending])\r\n\r\n  const handleRemoveList = useCallback(() => {\r\n    // eslint-disable-next-line no-alert\r\n    if (window.confirm('Please confirm you would like to remove this list')) {\r\n      dispatch(removeList(listUrl))\r\n    }\r\n  }, [dispatch, listUrl])\r\n\r\n  const handleEnableList = useCallback(() => {\r\n    dispatch(enableList(listUrl))\r\n  }, [dispatch, listUrl])\r\n\r\n  const handleDisableList = useCallback(() => {\r\n    dispatch(disableList(listUrl))\r\n  }, [dispatch, listUrl])\r\n\r\n  const { targetRef, tooltip, tooltipVisible } = useTooltip(\r\n    <div>\r\n      <Text>{list && listVersionLabel(list.version)}</Text>\r\n      <LinkExternal external href={`https://tokenlists.org/token-list?url=${listUrl}`}>\r\n        {t('See')}\r\n      </LinkExternal>\r\n      <Button variant=\"danger\" scale=\"xs\" onClick={handleRemoveList} disabled={Object.keys(listsByUrl).length === 1}>\r\n        {t('Remove')}\r\n      </Button>\r\n      {pending && (\r\n        <Button variant=\"text\" onClick={handleAcceptListUpdate} style={{ fontSize: '12px' }}>\r\n          {t('Update list')}\r\n        </Button>\r\n      )}\r\n    </div>,\r\n    { placement: 'right-end', trigger: 'click' },\r\n  )\r\n\r\n  if (!list) return null\r\n\r\n  return (\r\n    <RowWrapper active={isActive} key={listUrl} id={listUrlRowHTMLId(listUrl)}>\r\n      {tooltipVisible && tooltip}\r\n      {list.logoURI ? (\r\n        <ListLogo size=\"40px\" style={{ marginRight: '1rem' }} logoURI={list.logoURI} alt={`${list.name} list logo`} />\r\n      ) : (\r\n        <div style={{ width: '24px', height: '24px', marginRight: '1rem' }} />\r\n      )}\r\n      <Column style={{ flex: '1' }}>\r\n        <Row>\r\n          <Text bold>{list.name}</Text>\r\n        </Row>\r\n        <RowFixed mt=\"4px\">\r\n          <Text fontSize=\"12px\" mr=\"6px\" textTransform=\"lowercase\">\r\n            {list.tokens.length} {t('Tokens')}\r\n          </Text>\r\n          <span ref={targetRef}>\r\n            <CogIcon color=\"text\" width=\"12px\" />\r\n          </span>\r\n        </RowFixed>\r\n      </Column>\r\n      <Toggle\r\n        checked={isActive}\r\n        onChange={() => {\r\n          if (isActive) {\r\n            handleDisableList()\r\n          } else {\r\n            handleEnableList()\r\n          }\r\n        }}\r\n      />\r\n    </RowWrapper>\r\n  )\r\n})\r\n\r\nconst ListContainer = styled.div`\r\n  padding: 1rem 0;\r\n  height: 100%;\r\n  overflow: auto;\r\n`\r\n\r\nfunction ManageLists({\r\n  setModalView,\r\n  setImportList,\r\n  setListUrl,\r\n}: {\r\n  setModalView: (view: CurrencyModalView) => void\r\n  setImportList: (list: TokenList) => void\r\n  setListUrl: (url: string) => void\r\n}) {\r\n  const [listUrlInput, setListUrlInput] = useState<string>('')\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const lists = useAllLists()\r\n\r\n  // sort by active but only if not visible\r\n  const activeListUrls = useActiveListUrls()\r\n  const [activeCopy, setActiveCopy] = useState<string[] | undefined>()\r\n  useEffect(() => {\r\n    if (!activeCopy && activeListUrls) {\r\n      setActiveCopy(activeListUrls)\r\n    }\r\n  }, [activeCopy, activeListUrls])\r\n\r\n  const handleInput = useCallback((e) => {\r\n    setListUrlInput(e.target.value)\r\n  }, [])\r\n\r\n  const fetchList = useFetchListCallback()\r\n\r\n  const validUrl: boolean = useMemo(() => {\r\n    return uriToHttp(listUrlInput).length > 0 || Boolean(parseENSAddress(listUrlInput))\r\n  }, [listUrlInput])\r\n\r\n  const sortedLists = useMemo(() => {\r\n    const listUrls = Object.keys(lists)\r\n    return listUrls\r\n      .filter((listUrl) => {\r\n        // only show loaded lists, hide unsupported lists\r\n        return Boolean(lists[listUrl].current) && !UNSUPPORTED_LIST_URLS.includes(listUrl)\r\n      })\r\n      .sort((u1, u2) => {\r\n        const { current: l1 } = lists[u1]\r\n        const { current: l2 } = lists[u2]\r\n\r\n        // first filter on active lists\r\n        if (activeCopy?.includes(u1) && !activeCopy?.includes(u2)) {\r\n          return -1\r\n        }\r\n        if (!activeCopy?.includes(u1) && activeCopy?.includes(u2)) {\r\n          return 1\r\n        }\r\n\r\n        if (l1 && l2) {\r\n          return l1.name.toLowerCase() < l2.name.toLowerCase()\r\n            ? -1\r\n            : l1.name.toLowerCase() === l2.name.toLowerCase()\r\n            ? 0\r\n            : 1\r\n        }\r\n        if (l1) return -1\r\n        if (l2) return 1\r\n        return 0\r\n      })\r\n  }, [lists, activeCopy])\r\n\r\n  // temporary fetched list for import flow\r\n  const [tempList, setTempList] = useState<TokenList>()\r\n  const [addError, setAddError] = useState<string | undefined>()\r\n\r\n  useEffect(() => {\r\n    async function fetchTempList() {\r\n      fetchList(listUrlInput, false)\r\n        .then((list) => setTempList(list))\r\n        .catch(() => setAddError('Error importing list'))\r\n    }\r\n    // if valid url, fetch details for card\r\n    if (validUrl) {\r\n      fetchTempList()\r\n    } else {\r\n      setTempList(undefined)\r\n      if (listUrlInput !== '') {\r\n        setAddError('Enter valid list location')\r\n      }\r\n    }\r\n\r\n    // reset error\r\n    if (listUrlInput === '') {\r\n      setAddError(undefined)\r\n    }\r\n  }, [fetchList, listUrlInput, validUrl])\r\n\r\n  // check if list is already imported\r\n  const isImported = Object.keys(lists).includes(listUrlInput)\r\n\r\n  // set list values and have parent modal switch to import list view\r\n  const handleImport = useCallback(() => {\r\n    if (!tempList) return\r\n    setImportList(tempList)\r\n    setModalView(CurrencyModalView.importList)\r\n    setListUrl(listUrlInput)\r\n  }, [listUrlInput, setImportList, setListUrl, setModalView, tempList])\r\n\r\n  return (\r\n    <Wrapper>\r\n      <AutoColumn gap=\"14px\">\r\n        <Row>\r\n          <Input\r\n            id=\"list-add-input\"\r\n            scale=\"lg\"\r\n            placeholder={t('https:// or ipfs:// or ENS name')}\r\n            value={listUrlInput}\r\n            onChange={handleInput}\r\n          />\r\n        </Row>\r\n        {addError ? (\r\n          <Text color=\"failure\" style={{ textOverflow: 'ellipsis', overflow: 'hidden' }}>\r\n            {addError}\r\n          </Text>\r\n        ) : null}\r\n      </AutoColumn>\r\n      {tempList && (\r\n        <AutoColumn style={{ paddingTop: 0 }}>\r\n          <Card padding=\"12px 20px\">\r\n            <RowBetween>\r\n              <RowFixed>\r\n                {tempList.logoURI && <ListLogo logoURI={tempList.logoURI} size=\"40px\" />}\r\n                <AutoColumn gap=\"4px\" style={{ marginLeft: '20px' }}>\r\n                  <Text bold>{tempList.name}</Text>\r\n                  <Text color=\"textSubtle\" small textTransform=\"lowercase\">\r\n                    {tempList.tokens.length} {t('Tokens')}\r\n                  </Text>\r\n                </AutoColumn>\r\n              </RowFixed>\r\n              {isImported ? (\r\n                <RowFixed>\r\n                  <CheckmarkIcon width=\"16px\" mr=\"10px\" />\r\n                  <Text>{t('Loaded')}</Text>\r\n                </RowFixed>\r\n              ) : (\r\n                <Button   width=\"fit-content\" onClick={handleImport}>\r\n                  {t('Import')}\r\n                </Button>\r\n              )}\r\n            </RowBetween>\r\n          </Card>\r\n        </AutoColumn>\r\n      )}\r\n      <ListContainer>\r\n        <AutoColumn gap=\"md\">\r\n          {sortedLists.map((listUrl) => (\r\n            <ListRow key={listUrl} listUrl={listUrl} />\r\n          ))}\r\n        </AutoColumn>\r\n      </ListContainer>\r\n    </Wrapper>\r\n  )\r\n}\r\n\r\nexport default ManageLists\r\n"]},"metadata":{},"sourceType":"module"}