{"ast":null,"code":"import _taggedTemplateLiteral from\"C:/Users/97154/swap/hami/LokiswapUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3;import React,{useRef,useEffect}from'react';import styled from'styled-components';import{Modal,Text,Button,Flex,ButtonMenu,BalanceInput,HelpIcon,ButtonMenuItem,useTooltip}from'@pancakeswap/uikit';import{useTranslation}from'contexts/Localization';import{getBalanceNumber}from'utils/formatBalance';import useActiveWeb3React from'hooks/useActiveWeb3React';import RoiCalculatorFooter from'./RoiCalculatorFooter';import RoiCard from'./RoiCard';import useRoiCalculatorReducer,{CalculatorMode,EditingCurrency}from'./useRoiCalculatorReducer';import AnimatedArrow from'./AnimatedArrow';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var StyledModal=styled(Modal)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  width: 345px;\\n  & > :nth-child(2) {\\n    padding: 0;\\n  }\\n\"])));var ScrollableContainer=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  padding: 24px;\\n  max-height: 500px;\\n  overflow-y: auto;\\n  \",\" {\\n    max-height: none;\\n  }\\n\"])),function(_ref){var theme=_ref.theme;return theme.mediaQueries.sm;});var FullWidthButtonMenu=styled(ButtonMenu)(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  width: 100%;\\n\\n  & > button {\\n    width: 100%;\\n  }\\n\\n  opacity: \",\";\\n\"])),function(_ref2){var disabled=_ref2.disabled;return disabled?0.5:1;});var RoiCalculatorModal=function RoiCalculatorModal(_ref3){var onDismiss=_ref3.onDismiss,onBack=_ref3.onBack,earningTokenPrice=_ref3.earningTokenPrice,apr=_ref3.apr,displayApr=_ref3.displayApr,linkLabel=_ref3.linkLabel,linkHref=_ref3.linkHref,stakingTokenBalance=_ref3.stakingTokenBalance,stakingTokenSymbol=_ref3.stakingTokenSymbol,stakingTokenPrice=_ref3.stakingTokenPrice,multiplier=_ref3.multiplier,initialValue=_ref3.initialValue,_ref3$earningTokenSym=_ref3.earningTokenSymbol,earningTokenSymbol=_ref3$earningTokenSym===void 0?'LOKI':_ref3$earningTokenSym,_ref3$autoCompoundFre=_ref3.autoCompoundFrequency,autoCompoundFrequency=_ref3$autoCompoundFre===void 0?0:_ref3$autoCompoundFre,_ref3$performanceFee=_ref3.performanceFee,performanceFee=_ref3$performanceFee===void 0?0:_ref3$performanceFee,_ref3$isFarm=_ref3.isFarm,isFarm=_ref3$isFarm===void 0?false:_ref3$isFarm;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useActiveWeb3React=useActiveWeb3React(),account=_useActiveWeb3React.account;var balanceInputRef=useRef(null);console.log('debug->roi',stakingTokenPrice);console.log('debug->roi',earningTokenPrice);console.log('debug->roi',apr);var _useRoiCalculatorRedu=useRoiCalculatorReducer(stakingTokenPrice,earningTokenPrice,apr,autoCompoundFrequency,performanceFee),state=_useRoiCalculatorRedu.state,setPrincipalFromUSDValue=_useRoiCalculatorRedu.setPrincipalFromUSDValue,setPrincipalFromTokenValue=_useRoiCalculatorRedu.setPrincipalFromTokenValue,setStakingDuration=_useRoiCalculatorRedu.setStakingDuration,toggleCompounding=_useRoiCalculatorRedu.toggleCompounding,toggleEditingCurrency=_useRoiCalculatorRedu.toggleEditingCurrency,setCompoundingFrequency=_useRoiCalculatorRedu.setCompoundingFrequency,setCalculatorMode=_useRoiCalculatorRedu.setCalculatorMode,setTargetRoi=_useRoiCalculatorRedu.setTargetRoi;var _state$controls=state.controls,compounding=_state$controls.compounding,activeCompoundingIndex=_state$controls.activeCompoundingIndex,stakingDuration=_state$controls.stakingDuration,editingCurrency=_state$controls.editingCurrency;var _state$data=state.data,principalAsUSD=_state$data.principalAsUSD,principalAsToken=_state$data.principalAsToken;// Auto-focus input on opening modal\nuseEffect(function(){if(balanceInputRef.current){balanceInputRef.current.focus();}},[]);// If user comes to calculator from staking modal - initialize with whatever they put in there\nuseEffect(function(){if(initialValue){setPrincipalFromTokenValue(initialValue);}},[initialValue,setPrincipalFromTokenValue]);var _useTooltip=useTooltip(isFarm?t('“My Balance” here includes both LP Tokens in your wallet, and LP Tokens already staked in this farm.'):t('“My Balance” here includes both %assetSymbol% in your wallet, and %assetSymbol% already staked in this pool.',{assetSymbol:stakingTokenSymbol}),{placement:'top-end',tooltipOffset:[20,10]}),targetRef=_useTooltip.targetRef,tooltip=_useTooltip.tooltip,tooltipVisible=_useTooltip.tooltipVisible;var onBalanceFocus=function onBalanceFocus(){setCalculatorMode(CalculatorMode.ROI_BASED_ON_PRINCIPAL);};var editingUnit=editingCurrency===EditingCurrency.TOKEN?stakingTokenSymbol:'USD';var editingValue=editingCurrency===EditingCurrency.TOKEN?principalAsToken:principalAsUSD;var conversionUnit=editingCurrency===EditingCurrency.TOKEN?'USD':stakingTokenSymbol;var conversionValue=editingCurrency===EditingCurrency.TOKEN?principalAsUSD:principalAsToken;var onUserInput=editingCurrency===EditingCurrency.TOKEN?setPrincipalFromTokenValue:setPrincipalFromUSDValue;return/*#__PURE__*/_jsxs(StyledModal,{title:t('ROI Calculator'),onDismiss:onBack||onDismiss,onBack:onBack!==null&&onBack!==void 0?onBack:null,headerBackground:\"gradients.cardHeader\",children:[/*#__PURE__*/_jsxs(ScrollableContainer,{children:[/*#__PURE__*/_jsxs(Flex,{flexDirection:\"column\",mb:\"8px\",children:[/*#__PURE__*/_jsx(Text,{color:\"secondary\",bold:true,fontSize:\"12px\",textTransform:\"uppercase\",children:t('%asset% staked',{asset:stakingTokenSymbol})}),/*#__PURE__*/_jsx(BalanceInput,{currencyValue:\"\".concat(conversionValue,\" \").concat(conversionUnit),innerRef:balanceInputRef,placeholder:\"0.00\",value:editingValue,unit:editingUnit,onUserInput:onUserInput,switchEditingUnits:toggleEditingCurrency,onFocus:onBalanceFocus}),/*#__PURE__*/_jsxs(Flex,{justifyContent:\"space-between\",mt:\"8px\",children:[/*#__PURE__*/_jsx(Button,{scale:\"xs\",p:\"4px 16px\",width:\"68px\",variant:\"tertiary\",onClick:function onClick(){return setPrincipalFromUSDValue('100');},children:\"$100\"}),/*#__PURE__*/_jsx(Button,{scale:\"xs\",p:\"4px 16px\",width:\"68px\",variant:\"tertiary\",onClick:function onClick(){return setPrincipalFromUSDValue('1000');},children:\"$1000\"}),/*#__PURE__*/_jsx(Button,{disabled:stakingTokenBalance.lte(0)||!account,scale:\"xs\",p:\"4px 16px\",width:\"128px\",variant:\"tertiary\",onClick:function onClick(){return setPrincipalFromUSDValue(getBalanceNumber(stakingTokenBalance.times(stakingTokenPrice)).toString());},children:t('My Balance').toLocaleUpperCase()}),/*#__PURE__*/_jsx(\"span\",{ref:targetRef,children:/*#__PURE__*/_jsx(HelpIcon,{width:\"16px\",height:\"16px\",color:\"textSubtle\"})}),tooltipVisible&&tooltip]}),/*#__PURE__*/_jsx(Text,{mt:\"24px\",color:\"secondary\",bold:true,fontSize:\"12px\",textTransform:\"uppercase\",children:t('Staked for')}),/*#__PURE__*/_jsxs(FullWidthButtonMenu,{activeIndex:stakingDuration,onItemClick:setStakingDuration,scale:\"sm\",children:[/*#__PURE__*/_jsx(ButtonMenuItem,{variant:\"tertiary\",children:t('1D')}),/*#__PURE__*/_jsx(ButtonMenuItem,{variant:\"tertiary\",children:t('7D')}),/*#__PURE__*/_jsx(ButtonMenuItem,{variant:\"tertiary\",children:t('30D')}),/*#__PURE__*/_jsx(ButtonMenuItem,{variant:\"tertiary\",children:t('1Y')}),/*#__PURE__*/_jsx(ButtonMenuItem,{variant:\"tertiary\",children:t('5Y')})]})]}),/*#__PURE__*/_jsx(AnimatedArrow,{calculatorState:state}),/*#__PURE__*/_jsx(Flex,{children:/*#__PURE__*/_jsx(RoiCard,{earningTokenSymbol:earningTokenSymbol,calculatorState:state,setTargetRoi:setTargetRoi,setCalculatorMode:setCalculatorMode})})]}),/*#__PURE__*/_jsx(RoiCalculatorFooter,{isFarm:isFarm,apr:apr,displayApr:displayApr,autoCompoundFrequency:autoCompoundFrequency,multiplier:multiplier,linkLabel:linkLabel,linkHref:linkHref,performanceFee:performanceFee})]});};export default RoiCalculatorModal;","map":{"version":3,"sources":["C:/Users/97154/swap/hami/LokiswapUI/src/components/RoiCalculatorModal/index.tsx"],"names":["React","useRef","useEffect","styled","Modal","Text","Button","Flex","ButtonMenu","BalanceInput","HelpIcon","ButtonMenuItem","useTooltip","useTranslation","getBalanceNumber","useActiveWeb3React","RoiCalculatorFooter","RoiCard","useRoiCalculatorReducer","CalculatorMode","EditingCurrency","AnimatedArrow","StyledModal","ScrollableContainer","div","theme","mediaQueries","sm","FullWidthButtonMenu","disabled","RoiCalculatorModal","onDismiss","onBack","earningTokenPrice","apr","displayApr","linkLabel","linkHref","stakingTokenBalance","stakingTokenSymbol","stakingTokenPrice","multiplier","initialValue","earningTokenSymbol","autoCompoundFrequency","performanceFee","isFarm","t","account","balanceInputRef","console","log","state","setPrincipalFromUSDValue","setPrincipalFromTokenValue","setStakingDuration","toggleCompounding","toggleEditingCurrency","setCompoundingFrequency","setCalculatorMode","setTargetRoi","controls","compounding","activeCompoundingIndex","stakingDuration","editingCurrency","data","principalAsUSD","principalAsToken","current","focus","assetSymbol","placement","tooltipOffset","targetRef","tooltip","tooltipVisible","onBalanceFocus","ROI_BASED_ON_PRINCIPAL","editingUnit","TOKEN","editingValue","conversionUnit","conversionValue","onUserInput","asset","lte","times","toString","toLocaleUpperCase"],"mappings":"gOAAA,MAAOA,CAAAA,KAAP,EAAgBC,MAAhB,CAAwBC,SAAxB,KAAyC,OAAzC,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,OACEC,KADF,CAEEC,IAFF,CAGEC,MAHF,CAIEC,IAJF,CAKEC,UALF,CAOEC,YAPF,CAQEC,QARF,CASEC,cATF,CAUEC,UAVF,KAWO,oBAXP,CAaA,OAASC,cAAT,KAA+B,uBAA/B,CACA,OAASC,gBAAT,KAAiC,qBAAjC,CACA,MAAOC,CAAAA,kBAAP,KAA+B,0BAA/B,CACA,MAAOC,CAAAA,mBAAP,KAAgC,uBAAhC,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,MAAOC,CAAAA,uBAAP,EAAkCC,cAAlC,CAAkDC,eAAlD,KAAyE,2BAAzE,CACA,MAAOC,CAAAA,aAAP,KAA0B,iBAA1B,C,wFAqBA,GAAMC,CAAAA,WAAW,CAAGnB,MAAM,CAACC,KAAD,CAAT,iIAAjB,CAOA,GAAMmB,CAAAA,mBAAmB,CAAGpB,MAAM,CAACqB,GAAV,uKAIrB,kBAAGC,CAAAA,KAAH,MAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACC,YAAN,CAAmBC,EAAlC,EAJqB,CAAzB,CASA,GAAMC,CAAAA,mBAAmB,CAAGzB,MAAM,CAACK,UAAD,CAAT,iJAOZ,mBAAGqB,CAAAA,QAAH,OAAGA,QAAH,OAAmBA,CAAAA,QAAQ,CAAG,GAAH,CAAS,CAApC,EAPY,CAAzB,CAUA,GAAMC,CAAAA,kBAAqD,CAAG,QAAxDA,CAAAA,kBAAwD,OAiBxD,IAhBJC,CAAAA,SAgBI,OAhBJA,SAgBI,CAfJC,MAeI,OAfJA,MAeI,CAdJC,iBAcI,OAdJA,iBAcI,CAbJC,GAaI,OAbJA,GAaI,CAZJC,UAYI,OAZJA,UAYI,CAXJC,SAWI,OAXJA,SAWI,CAVJC,QAUI,OAVJA,QAUI,CATJC,mBASI,OATJA,mBASI,CARJC,kBAQI,OARJA,kBAQI,CAPJC,iBAOI,OAPJA,iBAOI,CANJC,UAMI,OANJA,UAMI,CALJC,YAKI,OALJA,YAKI,6BAJJC,kBAII,CAJJA,kBAII,gCAJiB,MAIjB,mDAHJC,qBAGI,CAHJA,qBAGI,gCAHoB,CAGpB,kDAFJC,cAEI,CAFJA,cAEI,+BAFa,CAEb,yCADJC,MACI,CADJA,MACI,uBADK,KACL,cACJ,oBAAcjC,cAAc,EAA5B,CAAQkC,CAAR,iBAAQA,CAAR,CACA,wBAAoBhC,kBAAkB,EAAtC,CAAQiC,OAAR,qBAAQA,OAAR,CACA,GAAMC,CAAAA,eAAe,CAAGhD,MAAM,CAA0B,IAA1B,CAA9B,CACAiD,OAAO,CAACC,GAAR,CAAY,YAAZ,CAA0BX,iBAA1B,EACAU,OAAO,CAACC,GAAR,CAAY,YAAZ,CAA0BlB,iBAA1B,EACAiB,OAAO,CAACC,GAAR,CAAY,YAAZ,CAA0BjB,GAA1B,EACA,0BAUIhB,uBAAuB,CAACsB,iBAAD,CAAoBP,iBAApB,CAAuCC,GAAvC,CAA4CU,qBAA5C,CAAmEC,cAAnE,CAV3B,CACEO,KADF,uBACEA,KADF,CAEEC,wBAFF,uBAEEA,wBAFF,CAGEC,0BAHF,uBAGEA,0BAHF,CAIEC,kBAJF,uBAIEA,kBAJF,CAKEC,iBALF,uBAKEA,iBALF,CAMEC,qBANF,uBAMEA,qBANF,CAOEC,uBAPF,uBAOEA,uBAPF,CAQEC,iBARF,uBAQEA,iBARF,CASEC,YATF,uBASEA,YATF,CAYA,oBAAkFR,KAAK,CAACS,QAAxF,CAAQC,WAAR,iBAAQA,WAAR,CAAqBC,sBAArB,iBAAqBA,sBAArB,CAA6CC,eAA7C,iBAA6CA,eAA7C,CAA8DC,eAA9D,iBAA8DA,eAA9D,CACA,gBAA6Cb,KAAK,CAACc,IAAnD,CAAQC,cAAR,aAAQA,cAAR,CAAwBC,gBAAxB,aAAwBA,gBAAxB,CAEA;AACAlE,SAAS,CAAC,UAAM,CACd,GAAI+C,eAAe,CAACoB,OAApB,CAA6B,CAC3BpB,eAAe,CAACoB,OAAhB,CAAwBC,KAAxB,GACD,CACF,CAJQ,CAIN,EAJM,CAAT,CAMA;AACApE,SAAS,CAAC,UAAM,CACd,GAAIwC,YAAJ,CAAkB,CAChBY,0BAA0B,CAACZ,YAAD,CAA1B,CACD,CACF,CAJQ,CAIN,CAACA,YAAD,CAAeY,0BAAf,CAJM,CAAT,CAMA,gBAA+C1C,UAAU,CACvDkC,MAAM,CACFC,CAAC,CAAC,sGAAD,CADC,CAEFA,CAAC,CACC,8GADD,CAEC,CAAEwB,WAAW,CAAEhC,kBAAf,CAFD,CAHkD,CAOvD,CAAEiC,SAAS,CAAE,SAAb,CAAwBC,aAAa,CAAE,CAAC,EAAD,CAAK,EAAL,CAAvC,CAPuD,CAAzD,CAAQC,SAAR,aAAQA,SAAR,CAAmBC,OAAnB,aAAmBA,OAAnB,CAA4BC,cAA5B,aAA4BA,cAA5B,CAUA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CAC3BlB,iBAAiB,CAACxC,cAAc,CAAC2D,sBAAhB,CAAjB,CACD,CAFD,CAIA,GAAMC,CAAAA,WAAW,CAAGd,eAAe,GAAK7C,eAAe,CAAC4D,KAApC,CAA4CzC,kBAA5C,CAAiE,KAArF,CACA,GAAM0C,CAAAA,YAAY,CAAGhB,eAAe,GAAK7C,eAAe,CAAC4D,KAApC,CAA4CZ,gBAA5C,CAA+DD,cAApF,CACA,GAAMe,CAAAA,cAAc,CAAGjB,eAAe,GAAK7C,eAAe,CAAC4D,KAApC,CAA4C,KAA5C,CAAoDzC,kBAA3E,CACA,GAAM4C,CAAAA,eAAe,CAAGlB,eAAe,GAAK7C,eAAe,CAAC4D,KAApC,CAA4Cb,cAA5C,CAA6DC,gBAArF,CACA,GAAMgB,CAAAA,WAAW,CAAGnB,eAAe,GAAK7C,eAAe,CAAC4D,KAApC,CAA4C1B,0BAA5C,CAAyED,wBAA7F,CAEA,mBACE,MAAC,WAAD,EACE,KAAK,CAAEN,CAAC,CAAC,gBAAD,CADV,CAEE,SAAS,CAAEf,MAAM,EAAID,SAFvB,CAGE,MAAM,CAAEC,MAAF,SAAEA,MAAF,UAAEA,MAAF,CAAY,IAHpB,CAIE,gBAAgB,CAAC,sBAJnB,wBAME,MAAC,mBAAD,yBACE,MAAC,IAAD,EAAM,aAAa,CAAC,QAApB,CAA6B,EAAE,CAAC,KAAhC,wBACE,KAAC,IAAD,EAAM,KAAK,CAAC,WAAZ,CAAwB,IAAI,KAA5B,CAA6B,QAAQ,CAAC,MAAtC,CAA6C,aAAa,CAAC,WAA3D,UACGe,CAAC,CAAC,gBAAD,CAAmB,CAAEsC,KAAK,CAAE9C,kBAAT,CAAnB,CADJ,EADF,cAIE,KAAC,YAAD,EACE,aAAa,WAAK4C,eAAL,aAAwBD,cAAxB,CADf,CAEE,QAAQ,CAAEjC,eAFZ,CAGE,WAAW,CAAC,MAHd,CAIE,KAAK,CAAEgC,YAJT,CAKE,IAAI,CAAEF,WALR,CAME,WAAW,CAAEK,WANf,CAOE,kBAAkB,CAAE3B,qBAPtB,CAQE,OAAO,CAAEoB,cARX,EAJF,cAcE,MAAC,IAAD,EAAM,cAAc,CAAC,eAArB,CAAqC,EAAE,CAAC,KAAxC,wBACE,KAAC,MAAD,EACE,KAAK,CAAC,IADR,CAEE,CAAC,CAAC,UAFJ,CAGE,KAAK,CAAC,MAHR,CAIE,OAAO,CAAC,UAJV,CAKE,OAAO,CAAE,yBAAMxB,CAAAA,wBAAwB,CAAC,KAAD,CAA9B,EALX,kBADF,cAUE,KAAC,MAAD,EACE,KAAK,CAAC,IADR,CAEE,CAAC,CAAC,UAFJ,CAGE,KAAK,CAAC,MAHR,CAIE,OAAO,CAAC,UAJV,CAKE,OAAO,CAAE,yBAAMA,CAAAA,wBAAwB,CAAC,MAAD,CAA9B,EALX,mBAVF,cAmBE,KAAC,MAAD,EACE,QAAQ,CAAEf,mBAAmB,CAACgD,GAApB,CAAwB,CAAxB,GAA8B,CAACtC,OAD3C,CAEE,KAAK,CAAC,IAFR,CAGE,CAAC,CAAC,UAHJ,CAIE,KAAK,CAAC,OAJR,CAKE,OAAO,CAAC,UALV,CAME,OAAO,CAAE,yBACPK,CAAAA,wBAAwB,CAACvC,gBAAgB,CAACwB,mBAAmB,CAACiD,KAApB,CAA0B/C,iBAA1B,CAAD,CAAhB,CAA+DgD,QAA/D,EAAD,CADjB,EANX,UAUGzC,CAAC,CAAC,YAAD,CAAD,CAAgB0C,iBAAhB,EAVH,EAnBF,cA+BE,aAAM,GAAG,CAAEf,SAAX,uBACE,KAAC,QAAD,EAAU,KAAK,CAAC,MAAhB,CAAuB,MAAM,CAAC,MAA9B,CAAqC,KAAK,CAAC,YAA3C,EADF,EA/BF,CAkCGE,cAAc,EAAID,OAlCrB,GAdF,cAkDE,KAAC,IAAD,EAAM,EAAE,CAAC,MAAT,CAAgB,KAAK,CAAC,WAAtB,CAAkC,IAAI,KAAtC,CAAuC,QAAQ,CAAC,MAAhD,CAAuD,aAAa,CAAC,WAArE,UACG5B,CAAC,CAAC,YAAD,CADJ,EAlDF,cAqDE,MAAC,mBAAD,EAAqB,WAAW,CAAEiB,eAAlC,CAAmD,WAAW,CAAET,kBAAhE,CAAoF,KAAK,CAAC,IAA1F,wBACE,KAAC,cAAD,EAAgB,OAAO,CAAC,UAAxB,UAAoCR,CAAC,CAAC,IAAD,CAArC,EADF,cAEE,KAAC,cAAD,EAAgB,OAAO,CAAC,UAAxB,UAAoCA,CAAC,CAAC,IAAD,CAArC,EAFF,cAGE,KAAC,cAAD,EAAgB,OAAO,CAAC,UAAxB,UAAoCA,CAAC,CAAC,KAAD,CAArC,EAHF,cAIE,KAAC,cAAD,EAAgB,OAAO,CAAC,UAAxB,UAAoCA,CAAC,CAAC,IAAD,CAArC,EAJF,cAKE,KAAC,cAAD,EAAgB,OAAO,CAAC,UAAxB,UAAoCA,CAAC,CAAC,IAAD,CAArC,EALF,GArDF,GADF,cA8DE,KAAC,aAAD,EAAe,eAAe,CAAEK,KAAhC,EA9DF,cA+DE,KAAC,IAAD,wBACE,KAAC,OAAD,EACE,kBAAkB,CAAET,kBADtB,CAEE,eAAe,CAAES,KAFnB,CAGE,YAAY,CAAEQ,YAHhB,CAIE,iBAAiB,CAAED,iBAJrB,EADF,EA/DF,GANF,cA8EE,KAAC,mBAAD,EACE,MAAM,CAAEb,MADV,CAEE,GAAG,CAAEZ,GAFP,CAGE,UAAU,CAAEC,UAHd,CAIE,qBAAqB,CAAES,qBAJzB,CAKE,UAAU,CAAEH,UALd,CAME,SAAS,CAAEL,SANb,CAOE,QAAQ,CAAEC,QAPZ,CAQE,cAAc,CAAEQ,cARlB,EA9EF,GADF,CA2FD,CApKD,CAsKA,cAAef,CAAAA,kBAAf","sourcesContent":["import React, { useRef, useEffect } from 'react'\r\nimport styled from 'styled-components'\r\nimport {\r\n  Modal,\r\n  Text,\r\n  Button,\r\n  Flex,\r\n  ButtonMenu,\r\n  Checkbox,\r\n  BalanceInput,\r\n  HelpIcon,\r\n  ButtonMenuItem,\r\n  useTooltip,\r\n} from '@pancakeswap/uikit'\r\nimport BigNumber from 'bignumber.js'\r\nimport { useTranslation } from 'contexts/Localization'\r\nimport { getBalanceNumber } from 'utils/formatBalance'\r\nimport useActiveWeb3React from 'hooks/useActiveWeb3React'\r\nimport RoiCalculatorFooter from './RoiCalculatorFooter'\r\nimport RoiCard from './RoiCard'\r\nimport useRoiCalculatorReducer, { CalculatorMode, EditingCurrency } from './useRoiCalculatorReducer'\r\nimport AnimatedArrow from './AnimatedArrow'\r\n\r\ninterface RoiCalculatorModalProps {\r\n  onDismiss?: () => void\r\n  onBack?: () => void\r\n  earningTokenPrice: number\r\n  apr: number\r\n  displayApr?: string\r\n  linkLabel: string\r\n  linkHref: string\r\n  stakingTokenBalance: BigNumber\r\n  stakingTokenSymbol: string\r\n  stakingTokenPrice: number\r\n  earningTokenSymbol?: string\r\n  multiplier?: string\r\n  autoCompoundFrequency?: number\r\n  performanceFee?: number\r\n  isFarm?: boolean\r\n  initialValue?: string\r\n}\r\n\r\nconst StyledModal = styled(Modal)`\r\n  width: 345px;\r\n  & > :nth-child(2) {\r\n    padding: 0;\r\n  }\r\n`\r\n\r\nconst ScrollableContainer = styled.div`\r\n  padding: 24px;\r\n  max-height: 500px;\r\n  overflow-y: auto;\r\n  ${({ theme }) => theme.mediaQueries.sm} {\r\n    max-height: none;\r\n  }\r\n`\r\n\r\nconst FullWidthButtonMenu = styled(ButtonMenu)<{ disabled?: boolean }>`\r\n  width: 100%;\r\n\r\n  & > button {\r\n    width: 100%;\r\n  }\r\n\r\n  opacity: ${({ disabled }) => (disabled ? 0.5 : 1)};\r\n`\r\n\r\nconst RoiCalculatorModal: React.FC<RoiCalculatorModalProps> = ({\r\n  onDismiss,\r\n  onBack,\r\n  earningTokenPrice,\r\n  apr,\r\n  displayApr,\r\n  linkLabel,\r\n  linkHref,\r\n  stakingTokenBalance,\r\n  stakingTokenSymbol,\r\n  stakingTokenPrice,\r\n  multiplier,\r\n  initialValue,\r\n  earningTokenSymbol = 'LOKI',\r\n  autoCompoundFrequency = 0,\r\n  performanceFee = 0,\r\n  isFarm = false,\r\n}) => {\r\n  const { t } = useTranslation()\r\n  const { account } = useActiveWeb3React()\r\n  const balanceInputRef = useRef<HTMLInputElement | null>(null)\r\n  console.log('debug->roi', stakingTokenPrice)\r\n  console.log('debug->roi', earningTokenPrice)\r\n  console.log('debug->roi', apr)\r\n  const {\r\n    state,\r\n    setPrincipalFromUSDValue,\r\n    setPrincipalFromTokenValue,\r\n    setStakingDuration,\r\n    toggleCompounding,\r\n    toggleEditingCurrency,\r\n    setCompoundingFrequency,\r\n    setCalculatorMode,\r\n    setTargetRoi,\r\n  } = useRoiCalculatorReducer(stakingTokenPrice, earningTokenPrice, apr, autoCompoundFrequency, performanceFee)\r\n\r\n  const { compounding, activeCompoundingIndex, stakingDuration, editingCurrency } = state.controls\r\n  const { principalAsUSD, principalAsToken } = state.data\r\n\r\n  // Auto-focus input on opening modal\r\n  useEffect(() => {\r\n    if (balanceInputRef.current) {\r\n      balanceInputRef.current.focus()\r\n    }\r\n  }, [])\r\n\r\n  // If user comes to calculator from staking modal - initialize with whatever they put in there\r\n  useEffect(() => {\r\n    if (initialValue) {\r\n      setPrincipalFromTokenValue(initialValue)\r\n    }\r\n  }, [initialValue, setPrincipalFromTokenValue])\r\n\r\n  const { targetRef, tooltip, tooltipVisible } = useTooltip(\r\n    isFarm\r\n      ? t('“My Balance” here includes both LP Tokens in your wallet, and LP Tokens already staked in this farm.')\r\n      : t(\r\n          '“My Balance” here includes both %assetSymbol% in your wallet, and %assetSymbol% already staked in this pool.',\r\n          { assetSymbol: stakingTokenSymbol },\r\n        ),\r\n    { placement: 'top-end', tooltipOffset: [20, 10] },\r\n  )\r\n\r\n  const onBalanceFocus = () => {\r\n    setCalculatorMode(CalculatorMode.ROI_BASED_ON_PRINCIPAL)\r\n  }\r\n\r\n  const editingUnit = editingCurrency === EditingCurrency.TOKEN ? stakingTokenSymbol : 'USD'\r\n  const editingValue = editingCurrency === EditingCurrency.TOKEN ? principalAsToken : principalAsUSD\r\n  const conversionUnit = editingCurrency === EditingCurrency.TOKEN ? 'USD' : stakingTokenSymbol\r\n  const conversionValue = editingCurrency === EditingCurrency.TOKEN ? principalAsUSD : principalAsToken\r\n  const onUserInput = editingCurrency === EditingCurrency.TOKEN ? setPrincipalFromTokenValue : setPrincipalFromUSDValue\r\n\r\n  return (\r\n    <StyledModal\r\n      title={t('ROI Calculator')}\r\n      onDismiss={onBack || onDismiss}\r\n      onBack={onBack ?? null}\r\n      headerBackground=\"gradients.cardHeader\"\r\n    >\r\n      <ScrollableContainer>\r\n        <Flex flexDirection=\"column\" mb=\"8px\">\r\n          <Text color=\"secondary\" bold fontSize=\"12px\" textTransform=\"uppercase\">\r\n            {t('%asset% staked', { asset: stakingTokenSymbol })}\r\n          </Text>\r\n          <BalanceInput\r\n            currencyValue={`${conversionValue} ${conversionUnit}`}\r\n            innerRef={balanceInputRef}\r\n            placeholder=\"0.00\"\r\n            value={editingValue}\r\n            unit={editingUnit}\r\n            onUserInput={onUserInput}\r\n            switchEditingUnits={toggleEditingCurrency}\r\n            onFocus={onBalanceFocus}\r\n          />\r\n          <Flex justifyContent=\"space-between\" mt=\"8px\">\r\n            <Button\r\n              scale=\"xs\"\r\n              p=\"4px 16px\"\r\n              width=\"68px\"\r\n              variant=\"tertiary\"\r\n              onClick={() => setPrincipalFromUSDValue('100')}\r\n            >\r\n              $100\r\n            </Button>\r\n            <Button\r\n              scale=\"xs\"\r\n              p=\"4px 16px\"\r\n              width=\"68px\"\r\n              variant=\"tertiary\"\r\n              onClick={() => setPrincipalFromUSDValue('1000')}\r\n            >\r\n              $1000\r\n            </Button>\r\n            <Button\r\n              disabled={stakingTokenBalance.lte(0) || !account}\r\n              scale=\"xs\"\r\n              p=\"4px 16px\"\r\n              width=\"128px\"\r\n              variant=\"tertiary\"\r\n              onClick={() =>\r\n                setPrincipalFromUSDValue(getBalanceNumber(stakingTokenBalance.times(stakingTokenPrice)).toString())\r\n              }\r\n            >\r\n              {t('My Balance').toLocaleUpperCase()}\r\n            </Button>\r\n            <span ref={targetRef}>\r\n              <HelpIcon width=\"16px\" height=\"16px\" color=\"textSubtle\" />\r\n            </span>\r\n            {tooltipVisible && tooltip}\r\n          </Flex>\r\n          <Text mt=\"24px\" color=\"secondary\" bold fontSize=\"12px\" textTransform=\"uppercase\">\r\n            {t('Staked for')}\r\n          </Text>\r\n          <FullWidthButtonMenu activeIndex={stakingDuration} onItemClick={setStakingDuration} scale=\"sm\">\r\n            <ButtonMenuItem variant=\"tertiary\">{t('1D')}</ButtonMenuItem>\r\n            <ButtonMenuItem variant=\"tertiary\">{t('7D')}</ButtonMenuItem>\r\n            <ButtonMenuItem variant=\"tertiary\">{t('30D')}</ButtonMenuItem>\r\n            <ButtonMenuItem variant=\"tertiary\">{t('1Y')}</ButtonMenuItem>\r\n            <ButtonMenuItem variant=\"tertiary\">{t('5Y')}</ButtonMenuItem>\r\n          </FullWidthButtonMenu>\r\n        </Flex>\r\n        <AnimatedArrow calculatorState={state} />\r\n        <Flex>\r\n          <RoiCard\r\n            earningTokenSymbol={earningTokenSymbol}\r\n            calculatorState={state}\r\n            setTargetRoi={setTargetRoi}\r\n            setCalculatorMode={setCalculatorMode}\r\n          />\r\n        </Flex>\r\n      </ScrollableContainer>\r\n      <RoiCalculatorFooter\r\n        isFarm={isFarm}\r\n        apr={apr}\r\n        displayApr={displayApr}\r\n        autoCompoundFrequency={autoCompoundFrequency}\r\n        multiplier={multiplier}\r\n        linkLabel={linkLabel}\r\n        linkHref={linkHref}\r\n        performanceFee={performanceFee}\r\n      />\r\n    </StyledModal>\r\n  )\r\n}\r\n\r\nexport default RoiCalculatorModal\r\n"]},"metadata":{},"sourceType":"module"}