{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/97154/swap/hami/LokiswapUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/97154/swap/hami/LokiswapUI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useCallback}from'react';import{useWeb3React,UnsupportedChainIdError}from'@web3-react/core';import{NoBscProviderError}from'@binance-chain/bsc-connector';import{NoEthereumProviderError,UserRejectedRequestError as UserRejectedRequestErrorInjected}from'@web3-react/injected-connector';import{UserRejectedRequestError as UserRejectedRequestErrorWalletConnect,WalletConnectConnector}from'@web3-react/walletconnect-connector';import{connectorLocalStorageKey}from'@pancakeswap/uikit';import{connectorsByName}from'utils/web3React';import{setupNetwork}from'utils/wallet';import useToast from'hooks/useToast';import{profileClear}from'state/profile';import{useAppDispatch}from'state';import{useTranslation}from'contexts/Localization';var useAuth=function useAuth(){var _useTranslation=useTranslation(),t=_useTranslation.t;var dispatch=useAppDispatch();var _useWeb3React=useWeb3React(),activate=_useWeb3React.activate,deactivate=_useWeb3React.deactivate;var _useToast=useToast(),toastError=_useToast.toastError;var login=useCallback(function(connectorID){var connector=connectorsByName[connectorID];if(connector){activate(connector,/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(error){var hasSetup,walletConnector;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(error instanceof UnsupportedChainIdError)){_context.next=7;break;}_context.next=3;return setupNetwork();case 3:hasSetup=_context.sent;if(hasSetup){activate(connector);}_context.next=9;break;case 7:window.localStorage.removeItem(connectorLocalStorageKey);if(error instanceof NoEthereumProviderError||error instanceof NoBscProviderError){toastError(t('Provider Error'),t('No provider was found'));}else if(error instanceof UserRejectedRequestErrorInjected||error instanceof UserRejectedRequestErrorWalletConnect){if(connector instanceof WalletConnectConnector){walletConnector=connector;walletConnector.walletConnectProvider=null;}toastError(t('Authorization Error'),t('Please authorize to access your account'));}else{toastError(error.name,error.message);}case 9:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());}else{toastError(t('Unable to find connector'),t('The connector config is wrong'));}},[t,activate,toastError]);var logout=useCallback(function(){dispatch(profileClear());deactivate();// This localStorage key is set by @web3-react/walletconnect-connector\nif(window.localStorage.getItem('walletconnect')){connectorsByName.walletconnect.close();connectorsByName.walletconnect.walletConnectProvider=null;}},[deactivate,dispatch]);return{login:login,logout:logout};};export default useAuth;","map":{"version":3,"sources":["C:/Users/97154/swap/hami/LokiswapUI/src/hooks/useAuth.ts"],"names":["useCallback","useWeb3React","UnsupportedChainIdError","NoBscProviderError","NoEthereumProviderError","UserRejectedRequestError","UserRejectedRequestErrorInjected","UserRejectedRequestErrorWalletConnect","WalletConnectConnector","connectorLocalStorageKey","connectorsByName","setupNetwork","useToast","profileClear","useAppDispatch","useTranslation","useAuth","t","dispatch","activate","deactivate","toastError","login","connectorID","connector","error","hasSetup","window","localStorage","removeItem","walletConnector","walletConnectProvider","name","message","logout","getItem","walletconnect","close"],"mappings":"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","sourcesContent":["import { useCallback } from 'react'\r\nimport { useWeb3React, UnsupportedChainIdError } from '@web3-react/core'\r\nimport { NoBscProviderError } from '@binance-chain/bsc-connector'\r\nimport {\r\n  NoEthereumProviderError,\r\n  UserRejectedRequestError as UserRejectedRequestErrorInjected,\r\n} from '@web3-react/injected-connector'\r\nimport {\r\n  UserRejectedRequestError as UserRejectedRequestErrorWalletConnect,\r\n  WalletConnectConnector,\r\n} from '@web3-react/walletconnect-connector'\r\nimport { ConnectorNames, connectorLocalStorageKey } from '@pancakeswap/uikit'\r\nimport { connectorsByName } from 'utils/web3React'\r\nimport { setupNetwork } from 'utils/wallet'\r\nimport useToast from 'hooks/useToast'\r\nimport { profileClear } from 'state/profile'\r\nimport { useAppDispatch } from 'state'\r\nimport { useTranslation } from 'contexts/Localization'\r\n\r\nconst useAuth = () => {\r\n  const { t } = useTranslation()\r\n  const dispatch = useAppDispatch()\r\n  const { activate, deactivate } = useWeb3React()\r\n  const { toastError } = useToast()\r\n\r\n  const login = useCallback(\r\n    (connectorID: ConnectorNames) => {\r\n      const connector = connectorsByName[connectorID]\r\n      if (connector) {\r\n        activate(connector, async (error: Error) => {\r\n          if (error instanceof UnsupportedChainIdError) {\r\n            const hasSetup = await setupNetwork()\r\n            if (hasSetup) {\r\n              activate(connector)\r\n            }\r\n          } else {\r\n            window.localStorage.removeItem(connectorLocalStorageKey)\r\n            if (error instanceof NoEthereumProviderError || error instanceof NoBscProviderError) {\r\n              toastError(t('Provider Error'), t('No provider was found'))\r\n            } else if (\r\n              error instanceof UserRejectedRequestErrorInjected ||\r\n              error instanceof UserRejectedRequestErrorWalletConnect\r\n            ) {\r\n              if (connector instanceof WalletConnectConnector) {\r\n                const walletConnector = connector as WalletConnectConnector\r\n                walletConnector.walletConnectProvider = null\r\n              }\r\n              toastError(t('Authorization Error'), t('Please authorize to access your account'))\r\n            } else {\r\n              toastError(error.name, error.message)\r\n            }\r\n          }\r\n        })\r\n      } else {\r\n        toastError(t('Unable to find connector'), t('The connector config is wrong'))\r\n      }\r\n    },\r\n    [t, activate, toastError],\r\n  )\r\n\r\n  const logout = useCallback(() => {\r\n    dispatch(profileClear())\r\n    deactivate()\r\n    // This localStorage key is set by @web3-react/walletconnect-connector\r\n    if (window.localStorage.getItem('walletconnect')) {\r\n      connectorsByName.walletconnect.close()\r\n      connectorsByName.walletconnect.walletConnectProvider = null\r\n    }\r\n  }, [deactivate, dispatch])\r\n\r\n  return { login, logout }\r\n}\r\n\r\nexport default useAuth\r\n"]},"metadata":{},"sourceType":"module"}